/*//////////////////////////////////////////////////////////////////
////       SKIRT -- an advanced radiative transfer code         ////
////       Â© Astronomical Observatory, Ghent University         ////
///////////////////////////////////////////////////////////////// */

#include "FatalError.hpp"
#include "Log.hpp"
#include "Mesh.hpp"
#include "NR.hpp"

using namespace std;

////////////////////////////////////////////////////////////////////

Mesh::Mesh()
    : _N(0), _tv(0)
{
}

////////////////////////////////////////////////////////////////////

void Mesh::setupSelfBefore()
{
    SimulationItem::setupSelfBefore();
    if (_N <= 0) throw FATALERROR("the number of bins should be positive");
}

////////////////////////////////////////////////////////////////////

void Mesh::setNumBins(int value)
{
    _N = value;
}

////////////////////////////////////////////////////////////////////

int Mesh::numBins() const
{
    return _N;
}

////////////////////////////////////////////////////////////////////

Array Mesh::mesh() const
{
    return _tv;
}

////////////////////////////////////////////////////////////////////

double Mesh::meshpoint(int i) const
{
    if (i<0 || i>_N) throw FATALERROR("asking for a mesh point outside the mesh");
    return _tv[i];
}

//////////////////////////////////////////////////////////////////////
