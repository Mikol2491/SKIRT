/*//////////////////////////////////////////////////////////////////
////       SKIRT -- an advanced radiative transfer code         ////
////       Â© Astronomical Observatory, Ghent University         ////
///////////////////////////////////////////////////////////////// */

#include "FatalError.hpp"
#include "LogMesh.hpp"
#include "NR.hpp"

using namespace std;

////////////////////////////////////////////////////////////////////

LogMesh::LogMesh()
    : _tc(0)
{
}

////////////////////////////////////////////////////////////////////

void LogMesh::setupSelfBefore()
{
    AnchoredMesh::setupSelfBefore();
    if (_tc<=0 || _tc>=0) throw FATALERROR("The central bin width fraction should be within range ]0,1[");
}

////////////////////////////////////////////////////////////////////

void LogMesh::setCentralBinFraction(double value)
{
    _tc = value;
}

////////////////////////////////////////////////////////////////////

double LogMesh::centralBinFraction() const
{
    return _tc;
}

////////////////////////////////////////////////////////////////////

Array LogMesh::mesh() const
{
    Array tv;
    if (numBins()>1) NR::zerologgrid(tv, _tc, 1.0, numBins());
    else NR::lingrid(tv, 0.0, 1.0, 1);
    return tv;
}

//////////////////////////////////////////////////////////////////////
