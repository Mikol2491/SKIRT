/*//////////////////////////////////////////////////////////////////
////       SKIRT -- an advanced radiative transfer code         ////
////       Â© Astronomical Observatory, Ghent University         ////
///////////////////////////////////////////////////////////////// */

#include "FatalError.hpp"
#include "Random.hpp"
#include "UniformCuboidGeometry.hpp"

using namespace std;

//////////////////////////////////////////////////////////////////////

UniformCuboidGeometry::UniformCuboidGeometry()
    : _rho(0)
{
}

////////////////////////////////////////////////////////////////////

void UniformCuboidGeometry::setupSelfBefore()
{
    BoxGeometry::setupSelfBefore();

    // compute the average density
    _rho = 1. / volume();
}

//////////////////////////////////////////////////////////////////////

double UniformCuboidGeometry::density(Position bfr) const
{
    return contains(bfr) ? _rho : 0.;
}

//////////////////////////////////////////////////////////////////////

Position UniformCuboidGeometry::generatePosition() const
{
    return _random->position(extent());
}

//////////////////////////////////////////////////////////////////////

double UniformCuboidGeometry::SigmaX() const
{
    return 1. / (ywidth() * zwidth());
}

//////////////////////////////////////////////////////////////////////

double UniformCuboidGeometry::SigmaY() const
{
    return 1. / (xwidth() * zwidth());
}

//////////////////////////////////////////////////////////////////////

double UniformCuboidGeometry::SigmaZ() const
{
    return 1. / (xwidth() * ywidth());
}

//////////////////////////////////////////////////////////////////////
